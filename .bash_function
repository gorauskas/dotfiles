# Bourne Again Shell Init Function File
# Jonas Gorauskas - 2007.03.17 22:00:00
# Modified: 2014-09-02 04:56:10

# Find a process by name
function psgrep() {
    ps aux | grep -v grep | grep -i -e VSZ -e $1
}

# Kill a process by Name
function pskill() {
    local pid
    pid=$(ps ax | grep $1 | grep -v grep | awk '{ print $1 }')
    echo -n "Killing $1 (Process $pid) ..."
    kill -9 $pid
    echo "Slaughtered ..."
}

# Watch output written to file
function watch() {
    if [ $# -ne 1 ]; then
        tail -f nohup.out
    else
        tail -f $1
    fi
}

function rot13() {
    if [ $# = 0 ] ; then
        tr "[a-m][n-z][A-M][N-Z]" "[n-z][a-m][N-Z][A-M]"
    else
        tr "[a-m][n-z][A-M][N-Z]" "[n-z][a-m][N-Z][A-M]" < $1
    fi
}

function chmog() {
    if [ $# -ne 4 ]; then
        echo "usage: chmog mode owner group file"
        return 1
    else
        chmod $1 $4
        chown $2 $4
        chgrp $3 $4
    fi
}

# requires superuser access in order to look at
# all nooks and crannies
function findall() {
    sudo find / -name ${1} -print ;
}

# Display Environment Information
function envinfo() {
    local i
    local is
    let ic=0

    for i in "${BASH_VERSINFO[@]}";
    do
        if [ $ic = 5 ]; then
            is="$is on a $i"
        else
            if [ $ic = 0 ]; then
                is="Bash Version $i"
            elif [ $ic = 1 ]; then
                is="$is.$i"
            elif [ $ic = 2 ]; then
                is="$is.$i("
            elif [ $ic = 3 ]; then
                is="$is$i)/"
            elif [ $ic = 4 ]; then
                is="$is$i"
            fi
        fi
        let ic=$ic+1
    done
    echo $is
}

# Open any document with any application
function open () {
    T=`xdg-mime query filetype $1`
    echo "Opening file" $1 "of type" $T "with" `xdg-mime query default $T`
    xdg-open $1
    echo "Open done!"
}

# clean a directory by removing all temp and backup files
# that were left behind
function clean () {
    echo -n "Are you sure you want to clean this directory? [y/n] "
    read yorn
    if test "$yorn" = "y"; then
        rm -f \#* *~ .*~ *.bak .*.bak *.tmp .*.tmp core a.out
        echo "Directory has been cleaned!"
    else
        echo "Clean operation has been aborted..."
    fi
}

# Start a simple python httpd on the current directory at the given port
function websrv () {
    command -v python >/dev/null 2>&1 || { echo >&2 "I require python but it's not installed.  Aborting."; exit 1; }
    if [ "$(python -c 'import sys; print(sys.version_info[0])')" -eq 2 ]; then
        python -m SimpleHTTPServer "$@"
    else
        python -m http.server "$@"
    fi
}


# cd and ls in one
function cl () {
    if [ -d "$1" ]; then
        cd "$1"
        dir
    else
        echo "bash: cl '%1' - Directory not found"
    fi
}

# make and cd into directory
function mcd () {
    mkdir -p "$1" && cd "$1";
}

# get your current internet ip
function myip () {
    echo `curl -s http://freegeoip.net/xml/`
}

# Git commit and push - CAP
function cap () {
    git add . ;
    git commit -m "$1" ;
    git pull ;
    git push ;
}

# Git compare local to remote - GDR git diff remote
function gdr () {
    git fetch origin ;
    git diff $1..origin/$1;
}
